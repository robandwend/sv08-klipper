[gcode_macro toolchanger_unload]
gcode: 

  {% set tool = params.T|int %}
  home_if_needed
  T{ tool }

  M104 S240

  move_to_load
  TEMPERATURE_WAIT SENSOR={printer.toolhead.extruder} MINIMUM=240
  M83                           ; set extruder to relative
  G1 E5 F500                   ; extrude 5 mm
  G1 E-50 F1000                   ; retract 5 cm
  G1 E-50 F1000                   ; retract 5 cm
  M82                            ; set extruder to absolute
  M400                          ; wait for buffer to clear
  M104 S0 
  M117 Unloading done - tool T{ tool }
  T0

